<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.7.0"/>
    <title>myproject API documentation</title>
<link rel="stylesheet" href="resources/bootstrap-reboot.min.css"><link rel="stylesheet" href="resources/syntax-highlighting.css"><link rel="stylesheet" href="resources/theme.css"><link rel="stylesheet" href="resources/layout.css"><link rel="stylesheet" href="resources/content.css"><link rel="stylesheet" href="resources/custom.css"><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
<div class="package-version">
    docs for <a href="https://github.com/mivanit/python-project-makefile-template">myproject</a> v0.0.2<br>
</div>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button">
            <img src="resources/svg/navtoggle.svg" alt="Toggle navigation"> 
        </label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#makefile-template-for-python-projects">Makefile Template for Python Projects</a>
  <ul>
    <li><a href="#targets">Targets</a></li>
    <li><a href="#makefile-variables">Makefile Variables</a></li>
  </ul></li>
</ul>


            <h2>Submodules</h2>
            <ul>
                    <li><a href="myproject/helloworld.html">helloworld</a></li>
            </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span>
            <img src="resources/svg/pdoc-logo.svg" alt="pdoc logo"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                        <a class="pdoc-button git-button" href="https://github.com/mivanit/python-project-makefile-template/blob/0.0.2/__init__.py">View Source on GitHub</a>
                    <h1 class="modulename">
myproject    </h1>

                        <div class="docstring"><h1 id="makefile-template-for-python-projects">Makefile Template for Python Projects</h1>

<p>I've ended up using the same makefile template for multiple Python projects, so I've decided to create a template repository for it.</p>

<p>Relevant ideological decisions:</p>

<ul>
<li><strong>github actions should be minimal, and mostly consist of calling makefile recipes</strong></li>
<li><a href="https://docs.astral.sh/uv/"><code>uv</code></a> for dependency management and packaging</li>
<li><a href="https://docs.pytest.org"><code>pytest</code></a> for testing</li>
<li><a href="https://github.com/python/mypy"><code>mypy</code></a> for static type checking</li>
<li><a href="https://docs.astral.sh/ruff/"><code>ruff</code></a> and <a href="https://github.com/hadialqattan/pycln"><code>pycln</code></a> for formatting</li>
<li><a href="https://pdoc.dev"><code>pdoc</code></a> for documentation generation</li>
<li><a href="https://en.wikipedia.org/wiki/Make_(software)"><code>make</code></a> for automation (I know there are better build tools out there and it's overkill, but <code>make</code> is universal)</li>
<li><a href="https://github.com/git"><code>git</code></a> for version control (a spicy take, I know)</li>
</ul>

<h2 id="targets">Targets</h2>

<h3 id="help-info">Help &amp; info</h3>

<ul>
<li><code>make help</code> Displays the help message listing all available make targets and variables.</li>
</ul>

<div class="pdoc-code codehilite">
<pre><span></span><code>$<span class="w"> </span>make<span class="w"> </span><span class="nb">help</span>
<span class="c1"># list make targets:</span>
<span class="w">    </span>make<span class="w"> </span>check<span class="w">                </span>run<span class="w"> </span>format<span class="w"> </span>and<span class="w"> </span>lint<span class="w"> </span>checks,<span class="w"> </span>tests,<span class="w"> </span>and<span class="w"> </span>typing<span class="w"> </span>checks
<span class="w">    </span>make<span class="w"> </span>clean<span class="w">                </span>cleaning<span class="w"> </span>up
<span class="w">    </span>make<span class="w"> </span>cov<span class="w">                  </span>generate<span class="w"> </span>coverage<span class="w"> </span>reports
<span class="w">    </span>make<span class="w"> </span>dep<span class="w">                  </span>sync<span class="w"> </span>and<span class="w"> </span><span class="nb">export</span><span class="w"> </span>deps<span class="w"> </span>to<span class="w"> </span><span class="k">$(</span>REQ_BASE<span class="k">)</span>,<span class="w"> </span><span class="k">$(</span>REQ_EXTRAS<span class="k">)</span>,<span class="w"> </span>and<span class="w"> </span><span class="k">$(</span>REQ_DEV<span class="k">)</span>
<span class="w">    </span>make<span class="w"> </span>dep-check<span class="w">            </span>checking<span class="w"> </span>uv.lock<span class="w"> </span>is<span class="w"> </span>good,<span class="w"> </span>exported<span class="w"> </span>requirements<span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span>date
<span class="w">    </span>make<span class="w"> </span>docs<span class="w">                 </span>generate<span class="w"> </span>all<span class="w"> </span>documentation
<span class="w">    </span>make<span class="w"> </span>docs-clean<span class="w">           </span>clean<span class="w"> </span>up<span class="w"> </span>docs
<span class="w">    </span>make<span class="w"> </span>docs-combined<span class="w">        </span>generate<span class="w"> </span>combined<span class="w"> </span>docs<span class="w"> </span><span class="k">in</span><span class="w"> </span>markdown<span class="w"> </span>and<span class="w"> </span>other<span class="w"> </span>formats
<span class="w">    </span>make<span class="w"> </span>docs-html<span class="w">            </span>generate<span class="w"> </span>html<span class="w"> </span>docs
<span class="w">    </span>make<span class="w"> </span>docs-md<span class="w">              </span>generate<span class="w"> </span>combined<span class="w"> </span>docs<span class="w"> </span><span class="k">in</span><span class="w"> </span>markdown
<span class="w">    </span>make<span class="w"> </span>format<span class="w">               </span>format<span class="w"> </span>the<span class="w"> </span><span class="nb">source</span><span class="w"> </span>code
<span class="w">    </span>make<span class="w"> </span>format-check<span class="w">         </span>run<span class="w"> </span>format<span class="w"> </span>check
<span class="w">    </span>make<span class="w"> </span><span class="nb">help</span>
<span class="w">    </span>make<span class="w"> </span>publish<span class="w">              </span>run<span class="w"> </span>all<span class="w"> </span>checks,<span class="w"> </span>build,<span class="w"> </span>and<span class="w"> </span><span class="k">then</span><span class="w"> </span>publish
<span class="w">    </span>make<span class="w"> </span>setup<span class="w">                </span>install<span class="w"> </span>and<span class="w"> </span>update<span class="w"> </span>via<span class="w"> </span>uv
<span class="w">    </span>make<span class="w"> </span><span class="nb">test</span><span class="w">                 </span>running<span class="w"> </span>tests
<span class="w">    </span>make<span class="w"> </span>typing<span class="w">               </span>running<span class="w"> </span><span class="nb">type</span><span class="w"> </span>checks
<span class="w">    </span>make<span class="w"> </span>verify-git<span class="w">           </span>checking<span class="w"> </span>git<span class="w"> </span>status
<span class="w">    </span>make<span class="w"> </span>version<span class="w">              </span>Current<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span><span class="k">$(</span>VERSION<span class="k">)</span>,<span class="w"> </span>last<span class="w"> </span>auto-uploaded<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span><span class="k">$(</span>LAST_VERSION<span class="k">)</span>
<span class="c1"># makefile variables</span>
<span class="w">    </span><span class="nv">PYTHON</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>uv<span class="w"> </span>run<span class="w"> </span>python
<span class="w">    </span><span class="nv">PYTHON_VERSION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>.12.0<span class="w"> </span>
<span class="w">    </span><span class="nv">PACKAGE_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>myproject
<span class="w">    </span><span class="nv">VERSION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>v0.0.2<span class="w"> </span>
<span class="w">    </span><span class="nv">LAST_VERSION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>v0.0.1<span class="w"> </span>
<span class="w">    </span><span class="nv">PYTEST_OPTIONS</span><span class="w"> </span><span class="o">=</span><span class="w">  </span>--cov<span class="o">=</span>.
</code></pre>
</div>

<ul>
<li><p><code>make</code> does the same as <code>make help</code></p></li>
<li><p><code>make version</code> Displays the current version of the project and the last auto-uploaded version (via tag). It also generates a commit log since the last version (and uses this for tag descriptions when publishing)</p></li>
</ul>

<h3 id="setupdeps">Setup/deps</h3>

<ul>
<li><p><code>make setup</code> install and update via poetry and setup shell (from <code>pyproject.toml</code>)</p></li>
<li><p><code>make dep</code> export dependencies for the base package, all extras, and dev requirements into <code>.github/requirements.txt</code>, <code>.github/requirements-extras.txt</code>, and <code>.github/requirements-dev.txt</code> respectively</p></li>
<li><p><code>make dep-check</code> checks that the <code>uv.lock</code> file is up to date and that the exported requirements are up to date</p></li>
</ul>

<h3 id="formatting">Formatting</h3>

<ul>
<li><p><code>make format</code> formats the code using <code>ruff</code> and <code>pycln</code></p></li>
<li><p><code>make format-check</code> checks the code formatting using <code>ruff</code> and `pycln</p></li>
</ul>

<h3 id="testing-and-linting">Testing and Linting</h3>

<ul>
<li><code>make test</code> runs tests using <code>pytest</code>, with data for coverage reports
<ul>
<li>you can pass <code>COV=0</code> to disable coverage reports</li>
</ul></li>
<li><p><code>make typing</code> runs type checking using <code>mypy</code></p></li>
<li><p><code>make check</code> runs format check, test, and type checks</p></li>
</ul>

<h3 id="docs">Docs</h3>

<p>Provided files for pdoc usage are:</p>

<ul>
<li><code>docs/make_docs.py</code> which generates documentation with a slightly custom style, automatically adding metadata read from your <code>pyproject.toml</code> file</li>
<li><code>docs/templates/</code> containing template files for both html and markdown docs</li>
<li><code>docs/resources/</code> containing some of the base <code>pdoc</code> resources as well as some custom icons for admonitions</li>
</ul>

<p>Provided recipes:</p>

<ul>
<li><code>make cov</code> generates coverage reports in text and html, as well as an svg badge. Will run tests if <code>.coverage</code> doesn't exist.</li>
<li><code>make docs-html</code> generates html documentation using pdoc</li>
<li><code>make docs-md</code> generates markdown documentation using pdoc</li>
<li><code>make docs-combined</code> generates single-file docs by using <code>pandoc</code> to process the <code>docs-md</code> output into other formats</li>
<li><code>make docs</code> generates all documentation</li>
<li><code>make docs-clean</code> cleans up the documentation generated files (keeps templates, resources, and <code>make_docs.py</code> script)</li>
</ul>

<h3 id="build-and-publish">Build and Publish</h3>

<ul>
<li><code>make publish</code> runs all checks, builds the project, and then publishes it. It also prompts for the new version number and handles tagging and pushing to the repository. Will also print your pypi token to the console, so you can copy and paste it into the prompt.</li>
<li><code>make build</code> builds the project using Poetry, assuming checks have been run</li>
<li><code>make verify-git</code> verifies the git status to ensure the repository is on the correct branch and is completely synced up and clean.</li>
<li><code>clean</code> Cleans up the build artifacts, caches, and temporary files.</li>
</ul>

<h2 id="makefile-variables">Makefile Variables</h2>

<ul>
<li><code>PACKAGE_NAME</code> Name of the package (default is <code><a href="">myproject</a></code>, change this).</li>
<li><code>PUBLISH_BRANCH</code> Branch to publish from (default is <code>main</code>).</li>
<li><code>PYPI_TOKEN_FILE</code> File containing the PyPI token (default is <code>.pypi-token</code>).</li>
<li><code>LAST_VERSION_FILE</code> File containing the last version (default is <code>.lastversion</code>).</li>
<li><code>COVERAGE_REPORTS_DIR</code> Directory for coverage reports (default is <code>docs/coverage</code>).</li>
<li><code>TESTS_DIR</code> Directory containing tests (default is <code>tests/</code>).</li>
<li><code>TESTS_TEMP_DIR</code> Temporary directory for tests (default is <code>tests/_temp</code>), which will be cleaned up.</li>
<li><code>PYPROJECT</code> Path to project config (default is <code>pyproject.toml</code>).</li>
<li><code>VERSION</code> Extracted automatically from <code>pyproject.toml</code>.</li>
<li><code>LAST_VERSION</code> Extracted from <code>.lastversion</code>, <code>NONE</code> if the file doesn't exist.</li>
<li><code>PYTHON_BASE</code> Base Python command (default is <code>python</code>). </li>
<li><code>RUN_GLOBAL</code> Flag to determine whether to run Python globally or via Poetry (default is <code>0</code>).</li>
<li><code>PYTHON</code> Python command determined by <code>RUN_GLOBAL</code>. Will have <code>poetry run</code> prepended if <code>RUN_GLOBAL</code> is <code>0</code>.</li>
<li><code>PYTEST_OPTIONS</code> Optional parameters to pass to <code>pytest</code>.</li>
<li><code>COV</code> Determines if coverage should be reported (<code>1</code> by default), prepends <code>--cov=.</code> to <code>PYTEST_OPTIONS</code> if <code>1</code>.</li>
<li><code>VERBOSE</code> If defined, will append <code>--verbose</code> to <code>PYTEST_OPTIONS</code>.</li>
</ul>
</div>

                        <input id="mod-myproject-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <div class="source-button-container">
            <label class="pdoc-button view-source-button" for="mod-myproject-view-source"><span>View Source</span></label>
            <div class="github-button-wrapper">
                <a class="pdoc-button github-link-button" href="https://github.com/mivanit/python-project-makefile-template/blob/0.0.2/__init__.py#L0-L2" target="_blank">
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>

                <br/>
                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">2</span></a><span class="sd">.. include:: ../README.md</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span></pre></div>


                <br/>
            </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>